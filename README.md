# wxDB
基于java开发的K-V数据库  
## 功能
2020.4.3更新  
目前支持基本的增删改查语句  
set key values  
get key  
delete key  
目前完成了：数据的持久化，单线程写事务，多线程读。


## 写在前边  
某天在知乎看到一篇回答：  
大学生如何实现一个数据库？ - 张原嘉的回答 - 知乎  
https://www.zhihu.com/question/35382593/answer/102269843  
看到大佬的回答，感觉很有意思，眼看着开学无望，便决定打发时间去尝试着写一个。  
我的设计思路也是从这篇回答中get到的，出于兴趣便尝试着去实现，在实现了一些基本功能后，决定提交到github上，之后有空会继续实现其他功能，希望自己能够完善下去吧（说不定还能当个毕设偷偷懒）。  

## 设计思路
索引：B+树  
![Alt text](https://github.com/NineXv/wxDB/tree/master/myPng/mmap.png)
1. 持久化问题：初始化时会判断磁盘中是否存在数据文件，如果存在，就利用mmap映射到内存，然后根据数据信息重新构建一棵B+树。  每一个节点都是单独的，利用偏移量去定位，当某节点发生了改变，就利用mmap修改磁盘中对应偏移量的数据，需要注意的是，我利用了fastJSON转化byte数组去保存数据  
2. 读写问题：copyOnWrite。每当有节点正在被写线程修改，就将该节点的数据复制一份保存到缓存集和中，当读线程需要读取数据时，会优先从缓存集合中拿取需要的节点，也就是并不会产生脏读的问题